# ! /bin/sh

internal_monitor=eDP1
external_monitor=HDMI1

monitor_add() {
	desktops=5 # How many desktops to move to the second monitor

	for desktop in $(bspc query -D -m $internal_monitor | sed "$desktops"q); do
		bspc desktop $desktop --to-monitor $external_monitor
	done

	# Remove "Desktop" created by bspwm
	bspc desktop Desktop --remove
	bspc wm --reorder-monitors $external_monitor $internal_monitor
}

monitor_remove() {
	bspc monitor $internal_monitor -a Desktop # Temp desktop because one desktop required per monitor

	# Move everything to external monitor to reorder desktops
	for desktop in $(bspc query -D -m $internal_monitor); do
		bspc desktop $desktop --to-monitor $external_monitor
	done

	# Now move everything back to internal monitor
	bspc monitor $external_monitor -a Desktop # Temp desktop

	for desktop in $(bspc query -D -m $external_monitor); do
		bspc desktop $desktop --to-monitor $internal_monitor
	done

	bspc desktop Desktop --remove # Remove temp desktops
	bspc monitor --remove $external_monitor
}

hdmi_connected=$(xrandr -q | grep 'HDMI1 connected')
if [[ $hdmi_connected ]]; then
	monitor_add
else
	monitor_remove
fi


sh ~/.fehbg &

bspc config top_padding 				0
$HOME/.config/polybar/launch.sh --forest
